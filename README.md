# Container Registry untagged image cleaner

Removes dangling and untagged images from Google's Container Registry serivce.

This code is intented to work on mounted on an HTTP Cloud Run instance and its expected to run scheduled on Cloud Scheduler
---

Dockerize the cleaner app and upload it onto Container Registry

```bash
docker build -t <container-registry-image-path> .
docker push <container-registry-image-path>
```

1. Mount the app on Cloud Run from the Docker image on GCR as a HTTP instance and only allocate resources when making requests to the endpoint
2. Create a Cloud Scheduler cron job that sends requests to the HTTP url generated by the previous step. The body for the request should be one of the following:

```json
{
  "repositories": "gcr.io/project-id/container"
}
```

```json
{
  "repositories": ["gcr.io/project-id/container", "us.gcr.io/project-id/container"]
}
```

The app will recursively search for dangling images to remove in every sub-repository of the repos on the request body.
